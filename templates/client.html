
<html>
	<head>
		<title>NetTalk</title>
		<!-- <image src="{{ url_for('static', filename='NetTalkLogo.png') }}"> -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
	</head>
	<body id="bg">
		<style>
		
		span.b {
			text-shadow: 2px, 2px, black;
			font-size: 20px;
		}
		
		txt {
			text-transform: capitalize;
			letter-spacing: 2px;
			font-family: Arial, Helvetica, sans-serif;
		}
		#bg {
			background-color: rgb(69,75,0);
			background-image: linear-gradient(Fuchsia, CornflowerBlue);
			margin: 2;
			background-repeat: no-repeat;
			background-attachment: fixed;
		}
		body {
			background-color: Gold;
		} 
		
		
		button {
			background-image: linear-gradient(GoldenRod, Gold);
			border: none;
			color: white;
			padding: 4px 30px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			margin: 4px 2px;
			border: 1px solid #ccc;
			border-radius: 4px;
			box-sizing: border-box;
		}
		input {
			width: 960px;
			padding: 4px 2px;
			display: inline-block;
			border: 1px solid #ccc;
			border-radius: 4px;
			box-sizing: border-box;
		}
		span.credits {
			font-size: 12px;
			color: light_gray;
		}
		a.credits {
			font-size: 14px;
			color: light_gray;
		}
		</style>
		<script type="text/javascript">
			username = {};
			users = [];
			canuse = true;
			function getRandomInt(max) {
				return Math.floor(Math.random() * Math.floor(max));
			}
			username = prompt("Please enter your username (or cancel to enter as guest)");
			for(i=0; i<users.length; i++){
				if(username == users[i].toString) {
					alert("User exists. Logging in as Guest");
					username = null;
				}
			}
			alert("MOBILE USERS, if you see a black page, try moving around or zooming. Sorry for the inconvenience!")
			alert("Also, if NetTalk Bot does not greet you, you are not properly connected. Try to close the tab and visit this webpage again. You may now continue without interruptions!")
			if(username == null || username == ""){
				username = "Guest" + getRandomInt(32768)
			}
			$(document).ready(function(){
			var socket = io.connect('http://127.0.0.1:5000');
			socket.on('connect', function(){
                socket.send('<br><b>' + username + '</b> entered the chatroom.');
				socket.send('<br><b>NetTalk Bot</b>> Hello, ' + username + "!");
				users.push(username);
			});
            $('#send').on('click', function(){
				if(document.getElementById('user_message').value != "") {
					socket.send('<br><b><span style=\'txt\'>'+username+"</b>> "+document.getElementById('user_message').value+'</span>');
					document.getElementById("send_message").reset()
				}
            });
            socket.on('message', function(fmsg){
			  document.getElementById('messages').innerHTML += fmsg;
            });
			});
			
		</script>
		<div id="mscroll">
		<span id="messages"></span>
		</div>
		<hr />
		<form id="send_message" action="javascript:void(0);">
		<input autocomplete="off" type="text" id="user_message" name="inputbox">
		<button id="send" name="send">Send</button>
		</form>
		<button onclick="darkMode()" id="darkmode">Dark mode (OFF)</button>
		<br>
		<br>
		<br>
		<span class="credits">Made by CreepiYT (Caty-the-AI) and Ad2017 (ad2017gd)</span><br>
		<a class="credits" href="https://github.com/Caty-the-AI/NetTalk">GitHub repo</a>
		<script>
			$("#mscroll").css("max-height", 300);
			$("#mscroll").css("overflow", "auto");
			$("#mscroll").css("height", 300);
			function darkMode(){
				button = document.getElementById('darkmode')
				if(button.innerHTML == "Dark mode (OFF)"){
					$("#bg").css("background-image", "none");
					$("#bg").css("background-color", "#202020");
					$("button").css("background-image", "none");
					$("button").css("background-color", "#000000");
					$("input").css("background-color", "#484848");
					$("span").css("color", "#FFFFFF");
					button.innerHTML = "Dark mode (ON)";
				} else {
					$("#bg").css("background-image", "linear-gradient(Fuchsia, CornflowerBlue)");
					$("#bg").css("background-color", "rgb(69,75,0)");
					$("button").css("background-image", "linear-gradient(GoldenRod, Gold)");
					$("input").css("background-color", "#FFFFFF");
					$("span").css("color", "#000000");
					button.innerHTML = "Dark mode (OFF)";
				}
			}
			window.setInterval(function() {
				var elem = document.getElementById('mscroll');
				elem.scrollTop = elem.scrollHeight;
			}, 250);
			var input = document.getElementById("user_message");
			input.addEventListener("keyup", function(event) {
				if (event.keyCode === 13) {
					if($('#user_message').val() != "") {
						document.getElementById("send").click();
						document.getElementById("send_message").reset()
					}
				}
			})
		</script>
	</body>
</html>